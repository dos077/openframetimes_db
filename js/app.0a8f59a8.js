(function(){"use strict";var e={225:function(e,t,r){r.d(t,{W4:function(){return P},W2:function(){return T}});r(4719);var n=r(291);const a=(e,t=2024)=>{let r=0,n=999;if(e.forEach((e=>{e>r?r=e:e<n&&(n=e)})),console.log("frame range",n,r),e.length<=t)return e;const a=[...e];while(a.length>t){const e=Math.round(a.length*Math.random());a.splice(e,100)}return a},s=["720p","1080p","1440p","WQHD","4K"],o=["low","medium","high","ultra"],c=["quality","balance","performance"],i=e=>{const t=JSON.parse(e);console.log("checking json",t);const{Info:r,Runs:n}=t;return r&&n&&n.length>0},l=e=>{const t={},r=e.split(" ").map((e=>e.toLowerCase())),n=[];return r.forEach((e=>{let r=!0;s.forEach((n=>{e.includes(n.toLocaleLowerCase())&&(t.resolution=n,r=!1)})),o.forEach((n=>{e.includes(n.toLocaleLowerCase())&&(t.gamePreset=n,r=!1)}));let a=!1;if(e.includes("fsr-")?a="FSR":e.includes("dlss-")&&(a="DLSS"),a){r=!1;let n=null;c.forEach((t=>{e.includes(t)&&(n=t)})),n&&(t.upscale=`${a}-${n}`)}r&&n.push(e)})),t.upscale||(t.upscale="off"),console.log("left over comment",n),{data:t,newComment:n.join(" ")}},u=e=>{const{Info:t,Runs:r}=JSON.parse(e),{Processor:n,ProcessName:s,CreationDate:o,OS:c,SystemRam:i,GPU:u,Comment:d,GPUDriverVersion:p}=t,m=[];r.forEach((e=>{e.CaptureData.TimeInSeconds.slice(1).forEach(((t,r)=>{m.push(t-e.CaptureData.TimeInSeconds[r])}))}));const h=l(d);return{info:{CPU:n,gameName:s.replace(".exe",""),creationDate:new Date(o),OS:c,RAM:i,GPU:u,comment:h.newComment,driver:p,...h.data},frameTimes:a(m)}},d=e=>{const t=e.name,r=t.substring(t.lastIndexOf(".")+1);return"json"===r.toLowerCase()};var p={isCapture:i,parseCapture:u,checkExt:d},m=r(1886),h=r.n(m);const f=["720p","1080p","1440p","WQHD","4K"],g=["low","medium","high","ultra"],w=["quality","balance","performance"],y=({name:e})=>{const t=e.substring(e.lastIndexOf(".")+1);return"csv"===t.toLowerCase()},v=["cpu","gpu","os","ram"],b=e=>{const t={};e[0].forEach(((r,n)=>{const a=v.includes(r)?r.toUpperCase():r;t[a]=e[1][n]}));const r=[],n=e[2].indexOf("frametime");return e.slice(3).forEach((e=>r.push(e[n]))),{info:t,frameTimes:a(r.map((e=>Math.round(10*parseFloat(e))/1e4)))}},C=e=>{const t=h().parse(e);if(t.errors&&t.errors.length>0)return!1;const r=t.data;return!!v.every((e=>r[0].includes(e)))&&!(!r[2]||!r[2].includes("frametime"))},k=e=>{const t={},r=e.split("_").map((e=>e.toLowerCase()));return t.gameName=r.shift(),r.forEach((e=>{f.forEach((r=>{e.includes(r.toLocaleLowerCase())&&(t.resolution=r)})),g.forEach((r=>{e.includes(r.toLocaleLowerCase())&&(t.gamePreset=r)}));let r=!1;if(e.includes("fsr-")?r="FSR":e.includes("dlss-")&&(r="DLSS"),r){let n=null;w.forEach((t=>{e.includes(t)&&(n=t)})),n&&(t.upscale=`${r}-${n}`)}})),t.upscale||(t.upscale="off"),t},S=(e,t)=>{const r=h().parse(e);if(r.errors&&r.errors.length>0)return!1;const{info:n,frameTimes:a}=b(r.data);return{info:{...n,...k(t)},frameTimes:a}};var I={checkExt:y,isCapture:C,parseCapture:S};const E=async e=>new Promise(((t,r)=>{const n=new FileReader;n.onload=e=>t(e.target.result),n.onerror=e=>r(e),n.readAsText(e)})),T=async e=>{const t=p.checkExt(e)||I.checkExt(e);if(!t)return!1;const r=await E(e);return p.checkExt(e)&&p.isCapture(r)?p.parseCapture(r):!(!I.checkExt(e)||!I.isCapture(r))&&I.parseCapture(r,e.name)},O=(e,t,r)=>r.every((r=>!e[r]&&!t[r]||e[r]===t[r])),P=(e,t=n.Kn)=>{const r=[e[0]];e.slice(1).forEach((e=>{const n=r.find((r=>O(r,e,t)));n&&n.frameTimes?n.frameTimes.push(...e.frameTimes):r.push(e)}));const a=r.map((e=>{const t=e.frameTimes.reduce(((e,t)=>e+t))/e.frameTimes.length;return{...e,avgFt:t}})).sort(((e,t)=>t.avgFt-e.avgFt));return a}},291:function(e,t,r){r.d(t,{Kn:function(){return s},bX:function(){return a},vO:function(){return n}});const n=["CPU","RAM","GPU","gameName","resolution","gamePreset","userId","frameTimes","upscale"],a=["syncCap","creationDate","driver","comment"],s=["CPU","RAM","GPU","gameName","resolution","gamePreset","syncCap","upscale"]},6147:function(e,t,r){var n=r(5102),a=r(751),s=r(9269);function o(e,t,r,n,a,o){const c=(0,s.up)("nav-bar"),i=(0,s.up)("q-header"),l=(0,s.up)("router-view"),u=(0,s.up)("q-page-container"),d=(0,s.up)("q-layout");return(0,s.wg)(),(0,s.j4)(d,{view:"hHh lpR fFf"},{default:(0,s.w5)((()=>[(0,s.Wm)(i,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c)])),_:1}),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(l)])),_:1})])),_:1})}r(4719);function c(e,t,r,n,a,o){const c=(0,s.up)("q-btn"),i=(0,s.up)("q-toolbar");return(0,s.wg)(),(0,s.j4)(i,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{flat:"",to:"/",disable:"home"===o.currentRoute},{default:(0,s.w5)((()=>[(0,s.Uk)(" Frametime DB Demo ")])),_:1},8,["disable"]),(0,s.Wm)(c,{flat:"",to:"/playground",disable:"playground"===o.currentRoute},{default:(0,s.w5)((()=>[(0,s.Uk)(" Playground ")])),_:1},8,["disable"])])),_:1})}var i=r(6957),l={name:"NavBar",data:()=>({drawerOn:!1}),computed:{currentRoute(){return this.$route.name},...(0,i.rn)(["currentUser"])}},u=r(7617),d=r(366),p=r(9804),m=r(1410),h=r.n(m);const f=(0,u.Z)(l,[["render",c]]);var g=f;h()(l,"components",{QToolbar:d.Z,QBtn:p.Z});var w={name:"App",components:{NavBar:g},data:()=>({drawerOn:!1}),created(){if(sessionStorage.redirect){const{redirect:e}=sessionStorage;delete sessionStorage.redirect,this.$router.push(e)}}},y=r(2446),v=r(7454),b=r(6974);const C=(0,u.Z)(w,[["render",o]]);var k=C;h()(w,"components",{QLayout:y.Z,QHeader:v.Z,QPageContainer:b.Z});var S=r(2201),I=r(3201);const E={class:"col-12"};function T(e,t,r,n,a,o){const c=(0,s.up)("simple-chart"),i=(0,s.up)("q-card-section"),l=(0,s.up)("q-card"),u=(0,s.up)("q-toolbar-title"),d=(0,s.up)("q-btn"),p=(0,s.up)("q-toolbar"),m=(0,s.up)("q-separator"),h=(0,s.up)("run-filters"),f=(0,s.up)("q-card-actions"),g=(0,s.up)("q-page");return(0,s.wg)(),(0,s.j4)(g,{padding:"",class:"text-left"},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{flat:""},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{class:"row q-col-gutter-md"},{default:(0,s.w5)((()=>[(0,s._)("div",E,[e.captures&&e.captures.length||o.previewGroups&&o.previewGroups.length?((0,s.wg)(),(0,s.j4)(c,{key:0,captures:o.previewGroups?null:e.captures,"capture-groups":o.previewGroups},null,8,["captures","capture-groups"])):((0,s.wg)(),(0,s.j4)(l,{key:1,flat:""},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{style:{"font-size":"14px"}},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.intro,((e,t)=>((0,s.wg)(),(0,s.iD)("p",{key:t},(0,I.zw)(e),1)))),128))])),_:1})])),_:1}))]),(0,s._)("div",{class:(0,I.C_)("main"===e.filterTab?"col-9":"col-3")},[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>["main"===e.filterTab?((0,s.wg)(),(0,s.j4)(u,{key:0},{default:(0,s.w5)((()=>[(0,s.Uk)(" Main Dataset ")])),_:1})):((0,s.wg)(),(0,s.j4)(d,{key:1,flat:"",label:"Main Set",onClick:t[0]||(t[0]=()=>e.filterTab="main")}))])),_:1}),(0,s.Wm)(m),(0,s.Wm)(h,{mini:"main"!==e.filterTab,"meta-pool":o.metaPool,"run-pool":e.runPool,onNewRuns:o.newFilteredRuns,"set-color":e.duoOn?"indigo":void 0},null,8,["mini","meta-pool","run-pool","onNewRuns","set-color"])],2),(0,s._)("div",{class:(0,I.C_)("second"===e.filterTab?"col-9":"col-3")},[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>["second"===e.filterTab?((0,s.wg)(),(0,s.j4)(u,{key:0},{default:(0,s.w5)((()=>[(0,s.Uk)(" Second Set ")])),_:1})):((0,s.wg)(),(0,s.j4)(d,{key:1,flat:"",border:"",label:"Second",onClick:t[1]||(t[1]=()=>e.filterTab="second")}))])),_:1}),(0,s.Wm)(m),(0,s.Wm)(h,{mini:"second"!==e.filterTab,"meta-pool":o.metaPool,"run-pool":e.runPool,onNewRuns:o.newFilteredRuns2,"set-color":"deep-orange"},null,8,["mini","meta-pool","run-pool","onNewRuns"])],2)])),_:1}),e.filteredRuns.length>0?((0,s.wg)(),(0,s.j4)(f,{key:0},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{onClick:o.loadCaptures,outline:""},{default:(0,s.w5)((()=>[(0,s.Uk)(" chart ")])),_:1},8,["onClick"])])),_:1})):(0,s.kq)("",!0)])),_:1})])),_:1})}var O=r(4117),P=r(7593);const R=["Graphics card benchmarks have existed for decades. While everything around those benchmarks have evolved beyond recognition, from the media the charts are embedded to the GFX/GPU themselves, the FPS bar charts seem immutable against the current of time. From grainy prints on magazine pages to the frames of a 4K Youtube video, the bar chart reigned supreme with frame per second as the dependent axis. Is it really as good as it gets for infographics of gaming hardware performance? Is the bar chart as good as it gets? Well, I think we can do better, a lot better.","With plenty of frame time measuring tool in our disposal and computers fast enough to log the data while rendering the game, we should move pass the era of frames per seconds. This project attempts to do so by charting refresh windows(30, 40, 60, etc., times per second) against some randomly sampled frames from recordings to see if what percentage of the refresh window actually refresh with a new frame.","I have uploaded a sample database with some CapframeX logs. They can be used for charting below. Code for this web app is on Github."];var x={name:"HomeView",components:{RunFilters:O.Z,SimpleChart:P.Z},data:()=>({intro:R,runPool:[],filteredRuns:[],filteredRuns2:[],previewCapture:null,duoOn:!1,localOn:!1,filterTab:"main"}),computed:{metaPool(){return this.$store.state.metas.metas},...(0,i.rn)({captures:e=>e.chart.captures,captureGroups:e=>e.chart.captureGroups}),previewGroups(){return this.duoOn&&this.captureGroups.length?this.captureGroups:this.localOn&&this.previewCapture?[this.captures,[this.previewCapture]]:null}},watch:{metaPool(e){if(e&&e.length){const t=[];e.forEach((e=>{e.runs.map((({runId:e})=>e)).forEach((e=>{t.includes(e)||t.push(e)}))})),this.runPool=t}},duoOn(e){e&&(this.localOn=!1)},localOn(e){e&&(this.duoOn=!1)},filterTab(e){"second"===e?(this.duoOn=!0,this.localOn=!1):"local"===e&&(this.duoOn=!1,this.localOn=!0)}},methods:{newFilteredRuns(e){this.filteredRuns=e},newFilteredRuns2(e){this.filteredRuns2=e},newPreview(e){this.previewCapture=e},loadCaptures(){const{filteredRuns:e,filteredRuns2:t,duoOn:r}=this;e&&e.length&&(r&&t&&t.length?this.$store.dispatch("chart/loadGroups",[e,t]):this.$store.dispatch("chart/loadCaptures",e))}},mounted(){this.metas&&0!==this.metas.length||this.$store.dispatch("metas/loadMetas")}},U=r(8906),L=r(8055),_=r(9501),D=r(8623),j=r(4492),W=r(4333);const Z=(0,u.Z)(x,[["render",T]]);var M=Z;h()(x,"components",{QPage:U.Z,QCard:L.Z,QCardSection:_.Z,QToolbar:d.Z,QToolbarTitle:D.Z,QBtn:p.Z,QSeparator:j.Z,QCardActions:W.Z});const $=[{path:"/",name:"home",component:M},{path:"/profile",name:"profile",component:()=>Promise.all([r.e(20),r.e(809),r.e(845)]).then(r.bind(r,31))},{path:"/admin",name:"admin",component:()=>Promise.all([r.e(20),r.e(328)]).then(r.bind(r,9675))},{path:"/playground",name:"playground",component:()=>Promise.all([r.e(20),r.e(809),r.e(271)]).then(r.bind(r,4188))}],q=(0,S.p7)({history:(0,S.PO)("/openframetimes_db/"),routes:$});var Q=q,G=r(140),F=r(5327),K=r(3837);const B={apiKey:"AIzaSyCBOg9TLihuWVuoNLXxlXKLMh7QUEQ3qYE",authDomain:"open-frametimes-db.firebaseapp.com",projectId:"open-frametimes-db",storageBucket:"open-frametimes-db.appspot.com",messagingSenderId:"507969102704",appId:"1:507969102704:web:c50d20eed901858156e5b5",measurementId:"G-N6TKEP4BDZ"},A=(0,F.ZF)(B);(0,K.IH)(A);var J=A,N=r(4167),z=e=>{const t=(0,N.v0)(e),r=new N.hJ;r.addScope("email"),r.addScope("profile");const n=async()=>{try{await(0,N.rh)(t,r)}catch(e){console.error("signin failed",e)}},a=async()=>{await t.signOut()},s=({afterLogIn:e,afterLogOut:r})=>{t.onAuthStateChanged((t=>{e&&t&&e(t),r&&!t&&r()}))};return{signIn:n,signOut:a,config:s}};const H=["email","photoURL","uid"],X=["displayName"],Y=e=>{const t={};return[...H,...X].forEach((r=>{e[r]&&(t[r]=e[r])})),t.created=e.created.toDate(),t.updated=e.updated.toDate(),t},V=e=>{const t=async t=>{try{const r=(0,G.JU)(e,"users",t.uid);let n=await(0,G.QT)(r);if(n.exists())throw Error("user already exist");const a={};return[...H,...X].forEach((e=>{t[e]&&(a[e]=t[e])})),await(0,G.pl)(r,{...a,created:new Date,updated:new Date}),n=await(0,G.QT)(r),Y(n.data())}catch(r){return console.error("error adding user",r),!1}},r=async({uid:t})=>{try{const r=(0,G.JU)(e,"users",t),n=await(0,G.QT)(r);return!!n.exists()&&Y(n.data())}catch(r){return console.error(r),!1}},n=async()=>{try{const t=(0,G.hJ)(e,"users"),r=await(0,G.PL)(t),n=[];return r.docs.forEach((e=>n.push(Y(e.data())))),n}catch(t){return console.error(t),!1}},a=async({uid:t,updates:r})=>{try{const n=(0,G.JU)(e,"users",t),a=await(0,G.QT)(n);if(!a.exists())throw Error(t,"does not exist and cannot update");const s={updated:new Date};X.forEach((e=>{r[e]&&(s[e]=r[e])})),await(0,G.r7)(n,s)}catch(n){console.error(n)}},s=async({uid:t})=>{try{await(0,G.oe)((0,G.JU)(e,"users",t))}catch(r){console.error(r)}};return{add:t,update:a,remove:s,get:r,getAll:n}};var ee=V,te=r(291);const re=e=>{if(!e.exists())throw Error("run not found");const t=e.data(),r={};return[...te.vO,...te.bX].forEach((e=>{t[e]&&(r[e]=t[e])})),r.created=t.created.toDate(),r.runId=e.id,r},ne=e=>{const t=async t=>{try{if(te.vO.some((e=>!t[e])))throw Error("incomplete run data");const r={created:new Date};[...te.vO,...te.bX].forEach((e=>{t[e]&&(r[e]=t[e])}));const n=await(0,G.ET)((0,G.hJ)(e,"runs"),r),a={created:r.created,type:"add",runId:n.id,userId:t.userId};return te.Kn.forEach((e=>{r[e]&&(a[e]=r[e])})),await(0,G.ET)((0,G.hJ)(e,"logs"),a),n.id}catch(r){return console.error(r),!1}},r=async t=>{try{const r=(0,G.JU)(e,"runs",t),n=await(0,G.QT)(r);return n.exists?re(n):(console.warn("run does not exists",t),!1)}catch(r){return console.error(r),!1}},n=async t=>{try{const r=(0,G.JU)(e,"runs",t),n=await(0,G.kl)(r);return n.exists?re(n):(console.warn("run does not exists",t),!1)}catch(n){const e=n.message.match("Failed to get document from cache");return e||console.warn(n),r(t)}},a=async t=>{const r=[];Object.keys(t).forEach((e=>{r.push((0,G.ar)(e,"==",t[e]))}));try{const t=(0,G.IO)((0,G.hJ)(e,"runs"),...r),n=await(0,G.PL)(t);return n.docs.map(re)}catch(n){return console.error(n),!1}},s=async({runId:t})=>{try{const r=await(0,G.QT)((0,G.JU)(e,"runs",t));if(!r.exists())throw Error("trying to remove nonexisting run");const n=re(r),a={created:new Date,type:"remove",runId:t,userId:n.userId};te.Kn.forEach((e=>{n[e]&&(a[e]=n[e])})),await(0,G.oe)((0,G.JU)(e,"runs",t)),await(0,G.ET)((0,G.hJ)(e,"logs"),a)}catch(r){console.error(r)}},o=async({uid:t})=>{try{const r=(0,G.IO)((0,G.hJ)(e,"runs"),(0,G.ar)("userId","==",t)),n=await(0,G.PL)(r),a=[];n.forEach((e=>a.push(s({rundId:e.id})))),await Promise.all(a)}catch(r){console.error(r)}};return{add:t,remove:s,removeAll:o,getByParams:a,get:n}};var ae=ne;const se=({runId:e},t,r)=>r.findIndex((t=>t.runId===e))===t,oe=e=>{const t=(0,G.hJ)(e,"metas"),r=async({type:e,name:r,runId:n,created:a})=>{const s=(0,G.IO)(t,(0,G.ar)("type","==",e),(0,G.ar)("name","==",r)),o=await(0,G.PL)(s);if(o.docs&&o.docs.length>0){const{runs:e}=o.docs[0].data();e.push({runId:n,created:a}),await(0,G.r7)((0,G.JU)(t,o.docs[0].id),{runs:e.filter(se)})}else{console.log("adding new meta entry");const s={type:e,name:r,runs:[{runId:n,created:a}]};console.log(s),await(0,G.ET)(t,s)}},n=async({type:e,name:r,runId:n,created:a})=>{console.log("deleting",e,r,n,a);const s=(0,G.IO)(t,(0,G.ar)("type","==",e),(0,G.ar)("name","==",r)),o=await(0,G.PL)(s),c=o.docs[0],{runs:i}=c.data(),l=i.map((e=>({...e,created:e.created.toDate()}))).filter((e=>n!==e.runId));console.log("new runs",l),l.length>0?await(0,G.r7)((0,G.JU)(t,c.id),{runs:l}):await(0,G.oe)((0,G.JU)(t,c.id))},a=async e=>{const t=[],{runId:a,created:s}=e,o="add"===e.type?r:n;console.log("processing update log",e),te.Kn.forEach((r=>{if(e[r]){const n=e[r];t.push(o({type:r,name:n,runId:a,created:s.toDate()}))}})),await Promise.all(t)},s=async()=>{try{const t=(0,G.hJ)(e,"logs"),r=(0,G.IO)(t,(0,G.Xo)("created")),n=await(0,G.PL)(r),a=[];for(let e=0;e<n.docs.length;e+=1){const t=n.docs[e],r=t.data();r.id=t.id,a.push(r)}return a}catch(t){return console.error(t),[]}},o=async()=>{const t=await s();for(let r=0;r<t.length;r+=1){const n=t[r];await a(n),await(0,G.oe)((0,G.JU)(e,"logs",n.id))}},c=async t=>{await(0,G.oe)((0,G.JU)(e,"logs",t))};return{processLogs:o,addMeta:r,removeMeta:n,getLogs:s,deleteLog:c}};var ce=oe;const ie=e=>{const t=e.data(),{runs:r}=t;return{...t,runs:r.map((({runId:e,created:t})=>({runId:e,created:t.toDate()})))}},le=e=>{const t=(0,G.hJ)(e,"metas"),r=async()=>{const e=await(0,G.PL)(t);return e.docs.map(ie)};return{getAll:r}};var ue=le;const de=(0,G.ad)(J);(0,G.ST)(de).catch((e=>{"failed-precondition"===e.code?console.warn("too many incidents open"):"unimplemented"===e.code?console.log("caching not supported on this browser"):console.warn(e)}));var pe={auth:z(J),userStore:ee(de),runStore:ae(de),adminStore:ce(de),metaStore:ue(de)};const me={logIn(){pe.auth.signIn()},async afterLogIn(e,t){const r=await pe.userStore.get(t);if(r){e.commit("setCurrentUser",r);const t=await pe.runStore.getByParams({userId:r.uid});e.commit("setUserRuns",t)}else{const r=await pe.userStore.add(t);e.commit("setCurrentUser",r)}},async logOut(e){await pe.auth.signOut(),e.commit("setCurrentUser",null),e.commit("setUserRuns",[])},async updateUser(e,t){const{uid:r}=e.state.currentUser;await pe.userStore.update({uid:r,updates:t});const n=await pe.userStore.get({uid:r});e.commit("setCurrentUser",n)},async deleteUser(e){await pe.runStore.removeAll(e.state.currentUser),await pe.userStore.remove(e.state.currentUser),e.dispatch("logOut")},async addRun(e,t){console.log("adding run",t);const{uid:r}=e.state.currentUser;await pe.runStore.add({...t,userId:r}),e.dispatch("loadUserRuns")},async loadUserRuns(e){const{uid:t}=e.state.currentUser,r=await pe.runStore.getByParams({userId:t});e.commit("setUserRuns",r)},async removeRun(e,t){await pe.runStore.remove(t),e.dispatch("loadUserRuns")}},he={setCurrentUser(e,t){e.currentUser=t},setUserRuns(e,t){e.userRuns=t}};var fe={actions:me,mutations:he};const ge=()=>{const e={metas:[],selectedRuns:[]};return te.Kn.forEach((t=>{e[t]=null,e[`${t}Disables`]=[],e[`${t}Actives`]=[]})),e},we={setMetas(e,t){e.metas=t,e.selectedRuns=[],te.Kn.forEach((t=>{e[t]=null,e[`${t}Disables`]=[],e[`${t}Actives`]=[]}))},updateOptions(e){const{metas:t,selectedRuns:r}=e;te.Kn.forEach((n=>{const a=t.filter((e=>e.type===n));if(r&&r.length){const t=[],s=[];a.forEach((e=>{e.runs.some((({runId:e})=>r.includes(e)))?t.push(e):s.push(e)})),e[`${n}Actives`]=t,e[`${n}Disables`]=s}else e[`${n}Actives`]=a,e[`${n}Disables`]=[]}))},selectRuns(e){const{metas:t}=e;let r=[];te.Kn.forEach((n=>{if(e[n]){const a=e[n],s=t.find((e=>e.type===n&&e.name===a)),o=s.runs.map((e=>e.runId));r=0===r.length?o:r.filter((e=>o.includes(e)))}})),e.selectedRuns=r},selectOption(e,{type:t,name:r}){e[t]?e[t]=null:e[t]=r}},ye={async loadMetas(e){const t=await pe.metaStore.getAll();e.commit("setMetas",t),e.commit("updateOptions")},select(e,{type:t,name:r}){e.commit("selectOption",{type:t,name:r}),e.commit("selectRuns"),e.commit("updateOptions")}};var ve={state:ge(),mutations:we,actions:ye,namespaced:!0},be=r(225);const Ce=()=>({captures:[],captureGroups:[],chartBase:.25,chartMax:4}),ke={setCaptures(e,t){e.captures=t},setGroups(e,t){e.captureGroups=t},setBase(e,t){e.chartBase=t},setMax(e,t){e.chartMax=t}},Se={async loadCaptures(e,t){const r=[];await Promise.all(t.map((async e=>{const t=await pe.runStore.get(e);t&&r.push(t)}))),e.commit("setCaptures",r)},async loadGroups(e,t){const r=[];await Promise.all(t.map((async e=>{const t=[];for(let r=0;r<e.length;r+=1){const n=await pe.runStore.get(e[r]);n&&t.push(n)}r.push((0,be.W4)(t))}))),e.commit("setGroups",r)}};var Ie={namespaced:!0,state:Ce(),mutations:ke,actions:Se};const Ee=()=>({logs:[]}),Te={setLogs(e,t){e.logs=t}},Oe={async adminUpdate(e){await pe.adminStore.processLogs(),e.dispatch("loadLogs")},async loadLogs(e){const t=await pe.adminStore.getLogs();e.commit("setLogs",t)},async rejectLogs(e,t){console.log("rejecting updates"),t.forEach((e=>console.log(e)));for(let r=0;r<t.length;r+=1){const e=t[r];"add"===e.type&&(await pe.runStore.remove({runId:e.runId}),await pe.adminStore.deleteLog(e.id))}e.dispatch("loadLogs")}};var Pe={state:Ee(),mutations:Te,actions:Oe,namespaced:!0};const Re=(0,i.MT)({state:{currentUser:null,userRuns:null},getters:{},mutations:{...fe.mutations},actions:{...fe.actions},modules:{metas:ve,chart:Ie,admin:Pe}});pe.auth.config({afterLogIn(e){Re.dispatch("afterLogIn",e)}});var xe=Re,Ue=r(1002),Le=r.n(Ue),_e={config:{},plugins:{},iconSet:Le()};(0,n.ri)(k).use(a.Z,_e).use(xe).use(Q).mount("#app")},7593:function(e,t,r){r.d(t,{Z:function(){return K}});var n=r(9269);const a=["id"];function s(e,t,r,s,o,c){const i=(0,n.up)("q-card-section"),l=(0,n.up)("q-separator"),u=(0,n.up)("q-space"),d=(0,n.up)("q-btn"),p=(0,n.up)("q-card-actions"),m=(0,n.up)("q-card");return(0,n.wg)(),(0,n.j4)(m,{flat:"",bordered:!r.mini},{default:(0,n.w5)((()=>[(0,n.Wm)(i,null,{default:(0,n.w5)((()=>[(0,n._)("canvas",{id:e.chartId},null,8,a)])),_:1}),(0,n.Wm)(l),r.mini?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(p,{key:0},{default:(0,n.w5)((()=>[(0,n.Wm)(u),(0,n.Wm)(d,{size:"md",flat:"",onClick:t[0]||(t[0]=e=>c.exportChart())},{default:(0,n.w5)((()=>[(0,n.Uk)("export")])),_:1})])),_:1}))])),_:1},8,["bordered"])}var o=r(7723),c=r(225),i=r(6957),l=(r(4719),r(291));const u=[{fps:240,ms:4.17},{fps:120,ms:8.34},{fps:90,ms:11.12},{fps:72,ms:13.89},{fps:60,ms:16.67},{fps:50,ms:20},{fps:40,ms:25},{fps:30,ms:33.34},{fps:20,ms:50},{fps:15,ms:66.67}],d=[{fps:240,ms:4.17},{fps:120,ms:8.34},{fps:60,ms:16.67},{fps:40,ms:25},{fps:30,ms:33.34},{fps:15,ms:66.67}],p={FSR:e=>`FSR-${e}`,DLSS:e=>`DLSS-${e}`},m=(e,t)=>{const r=1/t.fps;let n=0,a=0,s=0;for(let o=0;o<e.length;o+=1)if(s+=e[o],s>0){while(s>r)a+=1,s-=r;n+=1,s-=r}return n/(n+a)},h=e=>{const t=u.map((t=>({threshHold:t,compliance:m(e,t)})));return t},f=e=>{const t=d.map((t=>({threshHold:t,compliance:m(e,t)})));return t},g=u.map((({fps:e})=>e)).reverse(),w=d.map((({fps:e})=>e)).reverse(),y=(e,t)=>{if(!e||e.length<2)return null;const r=t.filter((t=>e.some((e=>e[t]))&&e.slice(1).every(((r,n)=>r[t]===e[n][t]))));return{shared:r,different:t.filter((e=>!r.includes(e)))}},v=({r:e,g:t,b:r},n)=>{const a=[];for(let s=0;s<n;s+=1){const o=1-.8*s/n;a.push(`rgba(${e}, ${t}, ${r}, ${o})`)}return a},b=({y:e,base:t,max:r})=>e>=1-t**r?r:Math.log(1-e)/Math.log(t),C=.5,k=9,S=()=>{let e=l.Kn,t=2;const r=t=>{t&&(e=t)},n=()=>t,a=e=>{t=e},s=(t,r,n)=>{const{frameTimes:a}=t,s=n<6?f(a):h(a),o=s.map((({compliance:e})=>b({y:e,base:r||C,max:n||k})));return{chartTitle:e.slice(0,3).map((e=>t[e])).join(", "),chartData:{labels:n<6?w:g,datasets:[{label:e.slice(3).filter((e=>t[e])).map((e=>t[e])).join("|"),data:o.reverse(),lineTension:.2}]}}},o=(t,r,n,a)=>{if(1===t.length)return s(t[0]);const o=[],c=y(t,e);console.log("plotting with keys",c),t.forEach(((e,t)=>{const{frameTimes:s}=e,i=a<6?f(s):h(s),l=i.map((({compliance:e})=>b({y:e,base:n||C,max:a||k})));o.push({label:c.different.filter((t=>e[t])).map((t=>p[t]?p[t](e[t]):e[t])).join("|"),data:l.reverse(),borderColor:r?r[t]:void 0,backgroundColor:r?r[t]:void 0,lineTension:.2})}));const i=[];let l="";return c.shared.forEach((e=>{"off"!==t[0][e]&&(l=l.concat(t[0][e],", ")),l.length>(a>5?58:24)&&(i.push(l),l="")})),l.length>0&&i.push(l),{chartTitle:i,chartData:{labels:a<6?w:g,datasets:o}}},c=(e,t,r,n)=>{const a=[],s=[];return e.forEach(((e,r)=>{a.push(...e),t&&s.push(...v(t[r],e.length))})),o(a,s.length?s:void 0,r,n)};return{plotMulti:o,plotChart:s,plotGroups:c,getExponent:n,setExponent:a,setRefKeys:r}};var I=S;const E=()=>{const e={};return e},T=({options:e,chartMax:t})=>{const r={...e};return r.aspectRatio=t>5?2:1,r},O=({options:e,chartBase:t,chartMax:r})=>{const n={...e};return n.scales={},n.scales.x={},n.scales.x.ticks={},n.scales.x.ticks.font={size:14},n.scales.x.display=!0,n.scales.y={},n.scales.y.display=!0,n.scales.y.ticks={},n.scales.y.ticks.font={size:14},n.scales.y.ticks.callback=e=>e<1?"0":e>=r?"100%":""+Math.round(1e3*(1-t**e))/10,n.scales.y.ticks.beginAtZero=!0,n.scales.y.ticks.stepSize=1,n.scales.y.max=r,n},P=({options:e,mini:t,chartTitle:r})=>{const n={...e};return n.plugins||(n.plugins={}),n.plugins.title={},n.plugins.title.display=!t,n.plugins.title.text=r,n},R=({options:e,chartBase:t,chartMax:r})=>{const n={...e};return n.plugins||(n.plugins={}),n.plugins.tooltip={},n.plugins.tooltip.intersect=!1,n.plugins.tooltip.mode="index",n.plugins.tooltip.bodyFont={size:14},n.plugins.tooltip.yAlign="top",n.plugins.tooltip.itemSort=(e,t)=>t.raw-e.raw,n.plugins.tooltip.callbacks={},n.plugins.tooltip.callbacks.label=e=>{const n=e.parsed.y,a=e.dataset.label;return n===r?`${a}: Full`:n<1?`${a}: Low`:`${a}: ${Math.round(1e3*(1-t**n))/10}%`},n.plugins.tooltip.callbacks.title=e=>`${e[0].label}FPS Target`,n},x=({options:e,color:t})=>{const r={...e};return r.plugins||(r.plugins={}),r.plugins.background={},r.plugins.background.color=t,r},U=[{r:57,g:73,b:171},{r:244,g:81,b:30}],L={};var _={name:"SimpleChart",props:["captures","captureGroups","refKeys","mini"],data:()=>({chart:null,chartData:null,chartTitle:null,plotter:I(),exponent:null,expOptions:[1.25,1.5,2,3,5],chartId:`chart-${(new Date).getTime()}`,screenWidth:document.documentElement.clientWidth}),computed:{...(0,i.rn)("chart",["chartBase","chartMax"])},watch:{captures(e){this.drawChart(e)},captureGroups(e){this.drawChart(null,e)},screenWidth:{immediate:!0,handler(e){e>999?(this.$store.commit("chart/setMax",9),this.$store.commit("chart/setBase",.5)):(this.$store.commit("chart/setMax",5),this.$store.commit("chart/setBase",.25))}},refKeys:{immediate:!0,handler(e){this.plotter.setRefKeys(e)}},chartBase(e,t){e!==t&&(this.captures?this.drawChart(this.captures):this.captureGroups&&this.drawChart(null,this.captureGroups))}},methods:{drawChart(e,t){const{plotter:r,refKeys:n,chartBase:a,chartMax:s}=this;let o=null;if(e&&e.length)o=r.plotGroups([(0,c.W4)(e,n)],null,a,s);else{if(!t||!t.length)return;o=r.plotGroups(t,U,a,s)}console.log("plotting new chart",o),L[this.chartId]?this.updateChart(o):this.newChart(o)},updateChart({chartData:e,chartTitle:t}){const r=L[this.chartId];r.clear(),r.destroy(),this.newChart({chartData:e,chartTitle:t})},newChart({chartData:e,chartTitle:t}){const{mini:r,chartId:n,chartBase:a,chartMax:s}=this,c=document.getElementById(n);console.log("drawing on canvas",c);let i=E();i=T({options:i,chartMax:s}),i=O({options:i,chartBase:a,chartMax:s}),i=P({options:i,mini:r,chartTitle:t}),i=R({options:i,chartBase:a,chartMax:s}),i=x({options:i,color:"#FFF"});const l=new o.ZP(c,{type:"line",data:e,options:i,plugins:[{id:"background",beforeDraw:(e,t,r)=>{const n=e.canvas.getContext("2d");n.save(),n.globalCompositeOperation="destination-over",n.fillStyle=r.color,n.fillRect(0,0,e.width,e.height),n.restore()}}]});L[n]=l},async exportChart(){this.pictureMode=!0,await new Promise((e=>setTimeout(e,200)));const e=document.getElementById(this.chartId),t=e.toDataURL("image/png").replace("image/png","image/octet-stream"),r=document.createElement("a"),n="frameTimes.png";r.setAttribute("href",t),r.setAttribute("download",n),r.click(),this.pictureMode=!1},getScreenWidth(){this.screenWidth=document.documentElement.clientWidth}},mounted(){window.addEventListener("resize",this.getScreenWidth),this.captures?this.drawChart(this.captures):this.captureGroups&&this.drawChart(null,this.captureGroups)},beforeUnmount(){L[this.chartId]&&(L[this.chartId].destroy(),L[this.chartId]=null),window.removeEventListener("resize",this.getScreenWidth)}},D=r(7617),j=r(8055),W=r(9501),Z=r(4492),M=r(4333),$=r(3139),q=r(9804),Q=r(1410),G=r.n(Q);const F=(0,D.Z)(_,[["render",s]]);var K=F;G()(_,"components",{QCard:j.Z,QCardSection:W.Z,QSeparator:Z.Z,QCardActions:M.Z,QSpace:$.Z,QBtn:q.Z})},4117:function(e,t,r){r.d(t,{Z:function(){return S}});var n=r(9269),a=r(3201);const s={class:"q-gutter-md"};function o(e,t,r,o,c,i){const l=(0,n.up)("q-item-label"),u=(0,n.up)("q-item-section"),d=(0,n.up)("q-item"),p=(0,n.up)("q-list"),m=(0,n.up)("filter-select");return(0,n.wg)(),(0,n.iD)("div",s,[r.mini?((0,n.wg)(),(0,n.j4)(p,{key:0},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(Object.entries(i.metaPicks),(([e,t])=>((0,n.wg)(),(0,n.j4)(d,{key:e},{default:(0,n.w5)((()=>[(0,n.Wm)(u,null,{default:(0,n.w5)((()=>[(0,n.Wm)(l,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(e),1)])),_:2},1024),(0,n.Wm)(l,{caption:"",class:(0,a.C_)(`text-${r.setColor}-7`)},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(t),1)])),_:2},1032,["class"])])),_:2},1024)])),_:2},1024)))),128)),e.selectedRuns.length?((0,n.wg)(),(0,n.j4)(d,{key:0},{default:(0,n.w5)((()=>[(0,n.Wm)(u,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(e.selectedRuns.length)+" runs selected ",1)])),_:1})])),_:1})):(0,n.kq)("",!0)])),_:1})):((0,n.wg)(),(0,n.j4)(p,{key:1},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.metaKeys,(t=>((0,n.wg)(),(0,n.j4)(m,{key:t,metas:i.metas,metaType:t,metaPick:i.metaPicks[t],selectedRuns:e.selectedRuns,setColor:r.setColor,onSelect:i.select},null,8,["metas","metaType","metaPick","selectedRuns","setColor","onSelect"])))),128)),e.selectedRuns.length?((0,n.wg)(),(0,n.j4)(d,{key:0},{default:(0,n.w5)((()=>[(0,n.Wm)(u,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(e.selectedRuns.length)+" runs selected ",1)])),_:1})])),_:1})):(0,n.kq)("",!0)])),_:1}))])}r(4719);var c=r(291);function i(e,t,r,s,o,c){const i=(0,n.up)("q-item-label"),l=(0,n.up)("q-chip"),u=(0,n.up)("q-item-section"),d=(0,n.up)("q-item");return c.isOn?((0,n.wg)(),(0,n.j4)(d,{key:0},{default:(0,n.w5)((()=>[(0,n.Wm)(u,null,{default:(0,n.w5)((()=>[(0,n.Wm)(i,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(r.metaType),1)])),_:1}),(0,n.Wm)(i,null,{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(c.activeOptions,(e=>((0,n.wg)(),(0,n.j4)(l,{key:e.name,clickable:"",onClick:t=>c.select(e),selected:e.name===r.metaPick,outline:"",color:c.getColor(e)},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(c.trimName(e.name)),1)])),_:2},1032,["onClick","selected","color"])))),128)),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(c.disabledOptions,(e=>((0,n.wg)(),(0,n.j4)(l,{key:e.name,outline:"",color:"grey-5"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(c.trimName(e.name)),1)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})):(0,n.kq)("",!0)}var l={name:"FilterSelect",props:["metas","metaPick","metaType","selectedRuns","setColor"],computed:{activeOptions(){const{metas:e,metaType:t,selectedRuns:r}=this,n=e.filter((e=>e.type===t));return r&&0!==r.length?n.filter((e=>e.runs.some((({runId:e})=>r.includes(e))))):n},disabledOptions(){const{metas:e,metaType:t,selectedRuns:r}=this;if(!r||0===r.length)return[];const n=e.filter((e=>e.type===t));return n.filter((e=>!e.runs.some((({runId:e})=>r.includes(e)))))},isOn(){return this.metas.filter((e=>e.type===this.metaType)).length>0}},methods:{select({name:e,type:t}){this.$emit("select",{name:e,type:t})},getColor({name:e}){if(this.setColor&&e===this.metaPick)return`${this.setColor}-7`},trimName(e){return!e||e.length<21?e:`${e.substring(0,19)}...`}}},u=r(7617),d=r(5246),p=r(2278),m=r(3712),h=r(1384),f=r(1410),g=r.n(f);const w=(0,u.Z)(l,[["render",i]]);var y=w;g()(l,"components",{QItem:d.Z,QItemSection:p.Z,QItemLabel:m.Z,QChip:h.Z});const v={};c.Kn.forEach((e=>{v[e]=null}));var b={name:"RunFilters",props:["metaPool","runPool","setColor","mini"],components:{FilterSelect:y},data:()=>({metaKeys:c.Kn,selectedRuns:[],...v}),computed:{metas(){const{metaPool:e,runPool:t}=this;if(!t||0===t.length)return e;const r=[];return e.forEach((e=>{e.runs.some((({runId:e})=>t.includes(e)))&&r.push(e)})),r},metaPicks(){const e={};return c.Kn.forEach((t=>{this[t]&&(e[t]=this[t])})),e},metaSelections(){const e=[],{metaPicks:t}=this;return Object.entries(t).forEach((([t,r])=>e.push({type:t,name:r}))),e},color(){return this.setColor||"indigo"}},methods:{select({name:e,type:t}){console.log("selecting",t,e),this[t]?this[t]=null:this[t]=e;const{metas:r}=this;let n=[];c.Kn.forEach((e=>{const t=this[e];if(t){const a=r.find((r=>r.type===e&&r.name===t)).runs.map((({runId:e})=>e));n=0===n.length?[...a]:n.filter((e=>a.includes(e)))}})),this.selectedRuns=n||[],this.$emit("newRuns",this.selectedRuns)}}},C=r(2146);const k=(0,u.Z)(b,[["render",o]]);var S=k;g()(b,"components",{QList:C.Z,QItem:d.Z,QItemSection:p.Z,QItemLabel:m.Z})}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}r.m=e,function(){var e=[];r.O=function(t,n,a,s){if(!n){var o=1/0;for(u=0;u<e.length;u++){n=e[u][0],a=e[u][1],s=e[u][2];for(var c=!0,i=0;i<n.length;i++)(!1&s||o>=s)&&Object.keys(r.O).every((function(e){return r.O[e](n[i])}))?n.splice(i--,1):(c=!1,s<o&&(o=s));if(c){e.splice(u--,1);var l=a();void 0!==l&&(t=l)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[n,a,s]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){r.f={},r.e=function(e){return Promise.all(Object.keys(r.f).reduce((function(t,n){return r.f[n](e,t),t}),[]))}}(),function(){r.u=function(e){return"js/"+({271:"playground",328:"admin",845:"profile"}[e]||e)+"."+{20:"80d6eb58",271:"ec13196a",328:"cec69f68",809:"24873c36",845:"32603a3c"}[e]+".js"}}(),function(){r.miniCssF=function(e){}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="frametime_db:";r.l=function(n,a,s,o){if(e[n])e[n].push(a);else{var c,i;if(void 0!==s)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==t+s){c=d;break}}c||(i=!0,c=document.createElement("script"),c.charset="utf-8",c.timeout=120,r.nc&&c.setAttribute("nonce",r.nc),c.setAttribute("data-webpack",t+s),c.src=n),e[n]=[a];var p=function(t,r){c.onerror=c.onload=null,clearTimeout(m);var a=e[n];if(delete e[n],c.parentNode&&c.parentNode.removeChild(c),a&&a.forEach((function(e){return e(r)})),t)return t(r)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:c}),12e4);c.onerror=p.bind(null,c.onerror),c.onload=p.bind(null,c.onload),i&&document.head.appendChild(c)}}}(),function(){r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){r.p="/openframetimes_db/"}(),function(){var e={143:0};r.f.j=function(t,n){var a=r.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var s=new Promise((function(r,n){a=e[t]=[r,n]}));n.push(a[2]=s);var o=r.p+r.u(t),c=new Error,i=function(n){if(r.o(e,t)&&(a=e[t],0!==a&&(e[t]=void 0),a)){var s=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;c.message="Loading chunk "+t+" failed.\n("+s+": "+o+")",c.name="ChunkLoadError",c.type=s,c.request=o,a[1](c)}};r.l(o,i,"chunk-"+t,t)}},r.O.j=function(t){return 0===e[t]};var t=function(t,n){var a,s,o=n[0],c=n[1],i=n[2],l=0;if(o.some((function(t){return 0!==e[t]}))){for(a in c)r.o(c,a)&&(r.m[a]=c[a]);if(i)var u=i(r)}for(t&&t(n);l<o.length;l++)s=o[l],r.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return r.O(u)},n=self["webpackChunkframetime_db"]=self["webpackChunkframetime_db"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=r.O(void 0,[998],(function(){return r(6147)}));n=r.O(n)})();
//# sourceMappingURL=app.0a8f59a8.js.map